# 📈 台灣股市數據分析專案

## 專案簡介

本專案提供完整的台灣股市技術分析工具，包含 K 線圖、技術指標（MA、MACD、RSI、布林通道）、成交量分析和多檔股票比較功能。

### ✨ 功能特色

- **專業 K 線圖**：使用 mplfinance 套件繪製專業股市圖表
- **技術指標完整**：
  - 移動平均線（MA5、MA10、MA20）
  - MACD 指標（快線、慢線、柱狀圖）
  - RSI 相對強弱指標
  - 布林通道（Bollinger Bands）
- **成交量分析**：紅綠K成交量圖表
- **多檔比較**：標準化價格、報酬率、波動率、成交量比較
- **本地數據**：內建模擬數據，無需網路連線
- **完整報表**：輸出 PNG 圖表和 PDF 報告

### 📊 預設分析股票

- 🔵 台積電（2330）
- 🟢 鴻海（2317）
- 🟣 聯發科（2454）

**💡 重要：可以自選股票！詳見下方「自訂股票」章節**

---

## 環境需求

- Python 3.8 或以上版本
- **無需網路連線！**（使用本地數據）
- 必要套件（請參考 requirements.txt）

---

## 安裝步驟

### 步驟 1：確認 Python 版本

```bash
python --version
```

確保版本為 3.8 或以上。

### 步驟 2：建立虛擬環境（建議）

**Windows：**
```bash
python -m venv venv
venv\Scripts\activate
```

**Mac/Linux：**
```bash
python3 -m venv venv
source venv/bin/activate
```

### 步驟 3：安裝依賴套件

```bash
pip install -r requirements.txt
```

**重要套件說明：**
- `mplfinance`：專業的金融圖表套件
- `matplotlib`：基礎視覺化
- `pandas`：數據處理
- `numpy`：數值運算
- `seaborn`：進階視覺化

### 步驟 4：生成本地數據（第一次執行）

```bash
python generate_local_data.py
```

**輸出範例：**
```
============================================================
台灣股市數據生成工具
============================================================
正在生成 台積電(2330) 的數據...
  [OK] 已儲存: data/2330_台積電.csv
  - 數據天數: 250 天
  - 價格範圍: 533.41 - 948.82
  - 平均成交量: 55,261 千股
...
```

**📌 注意：** Windows 終端機可能顯示中文亂碼，但這**不影響程式執行**！檔案會正確生成。

### 步驟 5：執行分析程式

```bash
python main.py
```

---

## 輸出結果

執行程式後，會在 `output` 資料夾中生成以下檔案：

### 個別股票分析圖

1. **2330_台積電_分析圖.png**
   - K線圖 + 移動平均線 + 布林通道
   - 成交量圖（紅綠K）
   - MACD 指標
   - RSI 指標

2. **2317_鴻海_分析圖.png**
3. **2454_聯發科_分析圖.png**

### 股票比較分析圖

4. **股票比較分析.png**
   - 標準化價格比較
   - 平均成交量比較
   - 價格波動率比較
   - 累計報酬率比較

### PDF 報表

5. **台股分析報告.pdf**
   - 包含所有圖表的完整報告

---

## 圖表說明

### K線圖 + 技術指標

#### 第一格：價格走勢
- **黑色線**：收盤價
- **紅色線**：MA5（5日移動平均）
- **藍色線**：MA10（10日移動平均）
- **綠色線**：MA20（20日移動平均）
- **灰色虛線**：布林通道上下軌
- **灰色區域**：布林通道範圍

#### 第二格：成交量
- **紅色柱**：當日上漲（收盤價 > 開盤價）
- **綠色柱**：當日下跌（收盤價 < 開盤價）

#### 第三格：MACD 指標
- **藍色線**：MACD 快線
- **紅色線**：Signal 訊號線
- **紅/綠柱**：MACD 柱狀圖（正值紅色，負值綠色）
- **使用方式**：
  - MACD > Signal：買入訊號
  - MACD < Signal：賣出訊號

#### 第四格：RSI 指標
- **紫色線**：RSI 值
- **紅色虛線**：超買線（70）
- **綠色虛線**：超賣線（30）
- **使用方式**：
  - RSI > 70：超買，可能下跌
  - RSI < 30：超賣，可能上漲

---

## 統計報告說明

程式執行時會在終端機輸出詳細的統計報告：

```
============================================================
📊 台灣股市數據分析報告
============================================================

【台積電(2330)】
------------------------------------------------------------
  價格統計：
    最高價：948.82 元
    最低價：533.41 元
    平均價：741.12 元
    最新價：892.45 元

  報酬率：+48.52%

  日波動率：1.52%

  成交量：
    平均成交量：55,261 萬張
    最大成交量：81,234 萬張

  技術指標（最新）：
    RSI(14)：68.32
    MACD：12.45

  趨勢判斷：
    短期趨勢（vs MA5）：上漲
    中期趨勢（MA5 vs MA20）：多頭
```

---

## 🔧 進階功能：自訂股票

### 方法 1：修改預設股票

開啟 `main.py`，找到第 354 行：

```python
# 載入數據
stock_codes = ['2330', '2317', '2454']  # ← 修改這裡！
```

**範例：改為分析金融股**
```python
stock_codes = ['2882', '2891', '2892']  # 國泰金、中信金、第一金
```

### 方法 2：新增更多股票數據

1. 開啟 `generate_local_data.py`

2. 找到第 61 行，修改股票列表：

```python
stocks = [
    ('台積電', '2330', 600, 0.015),   # (股票名稱, 代碼, 基準價, 波動率)
    ('鴻海', '2317', 100, 0.020),
    ('聯發科', '2454', 800, 0.025),
    # ↓ 新增你想要的股票
    ('國泰金', '2882', 50, 0.018),
    ('中信金', '2891', 25, 0.022),
]
```

3. 重新執行數據生成：
```bash
python generate_local_data.py
```

4. 修改 `main.py` 中的 `stock_codes`：
```python
stock_codes = ['2330', '2882', '2891']  # 台積電、國泰金、中信金
```

5. 執行分析：
```bash
python main.py
```

---

## ⚠️ 常見問題

### Q1：終端機顯示中文亂碼？

**現象：**
```
���b�ͦ� �x�n�q(2330) ���ƾ�...  ← 亂碼
```

**原因：** Windows 命令提示字元使用 Big5 編碼，無法正確顯示 UTF-8 中文。

**解決方法：**
- **不影響程式執行！** 檔案會正確生成，圖表也會正確顯示中文
- 如果需要看清楚訊息，可以：
  1. 使用 Windows Terminal（支援 UTF-8）
  2. 使用 Jupyter Lab
  3. 直接查看輸出的圖表檔案

### Q2：無法安裝 mplfinance？

**錯誤訊息：**
```
ERROR: Could not find a version that satisfies the requirement mplfinance
```

**解決方法：**
```bash
# 更新 pip
python -m pip install --upgrade pip

# 重新安裝
pip install mplfinance
```

### Q3：圖表無法顯示？

**解決方法：**
- 圖表會自動儲存到 `output` 資料夾
- 如果視窗無法顯示，可直接開啟 PNG 檔案
- 或註解掉 `main.py` 最後的 `plt.show()`

### Q4：想分析更長的時間範圍？

**解決方法：**
開啟 `generate_local_data.py`，修改第 68 行：

```python
# 原本
df = generate_stock_data(stock_name, stock_code, base_price, volatility, days=250)

# 改為
df = generate_stock_data(stock_name, stock_code, base_price, volatility, days=500)  # 500天
```

重新執行 `python generate_local_data.py`

### Q5：如何調整技術指標參數？

**RSI 週期：**
```python
# main.py 第 66 行
df = calculate_rsi(df, period=14)  # 改為其他週期，例如 period=9
```

**MACD 參數：**
```python
# main.py 第 57 行
df = calculate_macd(df, fast=12, slow=26, signal=9)  # 可調整 fast, slow, signal
```

**布林通道：**
```python
# main.py 第 76 行
df = calculate_bollinger_bands(df, period=20, std_dev=2)  # 可調整週期和標準差
```

---

## 📚 學習重點

### 完成本專案後，你將學會：

#### 金融數據處理
- ✅ 股票數據結構（OHLCV）
- ✅ 日期時間索引處理
- ✅ 價格標準化與報酬率計算
- ✅ 滾動計算（移動平均）

#### 技術分析
- ✅ 移動平均線（MA）的計算與應用
- ✅ MACD 指標的原理與判讀
- ✅ RSI 超買超賣判斷
- ✅ 布林通道的使用

#### 視覺化技巧
- ✅ 多子圖佈局（4x1 網格）
- ✅ 共享 X 軸設定
- ✅ 柱狀圖顏色條件設定
- ✅ 填充區域（fill_between）
- ✅ 雙軸圖表

---

## 🎓 進階練習

### 練習 1：新增更多技術指標

**建議新增：**
- KD 指標
- 威廉指標（Williams %R）
- 均線乖離率

### 練習 2：建立交易訊號

根據技術指標產生買賣訊號：
- MACD 黃金交叉/死亡交叉
- RSI 超買超賣
- 均線多頭/空頭排列

### 練習 3：回測系統

實作簡單的回測系統：
- 根據訊號模擬買賣
- 計算投資報酬率
- 比較不同策略的績效

### 練習 4：真實數據

使用 `yfinance` 套件載入真實股票數據：
```python
import yfinance as yf

# 下載台積電數據
df = yf.download('2330.TW', start='2024-01-01', end='2024-12-31')
```

---

## 📖 延伸資源

### 技術分析相關
- [技術分析入門](https://www.investopedia.com/technical-analysis-4689657)
- [MACD 指標詳解](https://www.investopedia.com/terms/m/macd.asp)
- [RSI 指標應用](https://www.investopedia.com/terms/r/rsi.asp)

### Python 金融分析
- [mplfinance 文檔](https://github.com/matplotlib/mplfinance)
- [yfinance 套件](https://pypi.org/project/yfinance/)
- [TA-Lib 技術分析庫](https://github.com/mrjbq7/ta-lib)

---

## 🎯 專案亮點

- **完全離線**：無需網路即可執行
- **專業級圖表**：使用金融專用套件
- **指標齊全**：包含最常用的技術指標
- **易於擴充**：模組化設計，方便新增功能
- **詳細註解**：每個函數都有清楚說明

---

## ⚡ 快速執行指令

```bash
# 完整執行流程
cd "台灣股市數據分析專案"
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
python generate_local_data.py
python main.py
```

---

## 🎉 恭喜完成！

你現在已經掌握了：
- 📊 股票數據分析技巧
- 📈 技術指標計算與應用
- 🎨 專業金融圖表製作
- 💡 投資分析基礎概念

**下一步：**
- 嘗試分析不同的股票
- 實作自己的交易策略
- 結合真實數據進行分析

---

**專案版本：** 1.0
**最後更新：** 2025-11-25
**作者：** Python 資料視覺化教學團隊
